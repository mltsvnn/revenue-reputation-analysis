# Эконометрический анализ влияния онлайн-репутации на выручку сетей косметики

Проект демонстрирует завершённый аналитический пайплайн: от сбора и предобработки данных до эконометрического моделирования, интерпретации результатов и формирования выводов. В работе рассматриваются крупнейшие сети косметики и парфюмерии в РФ в период с 2015 по 2024 гг. Полученные результаты позволяют количественно оценить влияние онлайн-репутации и макропоказателей на годовую выручку компаний и сформулировать практические рекомендации по приоритетам маркетинговых инвестиций и управлению клиентским опытом. 


# Содержание репозитория

## **data/**  
В папке data/ хранится файл df_aggregated.csv — итоговая агрегированная таблица, содержащая ежегодные метрики по 9 рассматриваемым сетям в период с 2015 по 2024 гг.  Переменные можно разделить на четыре группы по источнику их формирования: отзывы пользователей, поисковая активность, макроэкономические индикаторы, финансовые показатели компаний. Итоговый датасет составит 90 наблюдений (9 компаний × 10 лет).

Ниже  подробно описаны группы факторов, их источники и итоговые переменные.

| Группа данных           | Источник / сбор                        | Агрегирование                         | Итоговые переменные (имя в CSV)                         | Описание и единицы                      |
|-------------------------|----------------------------------------|---------------------------------------|--------------------------------------------------------|-----------------------------------------|
| **Отзывы**              | Otzovik, Яндекс.Карты  | Сбор «сырых» отзывов по каждому магазину сети, затем годовая агрегация по сети | avg_rating<br>review_vol<br>neg_share<br>avg_sentiment<br>AvgLikes<br>VarRating | - avg_rating (float): средний звёздочный рейтинг за год по сети <br>- review_vol (int): общее число отзывов за год<br>- neg_share (float): доля негативных отзывов (доля отзывов с оценкой ≤2 звезды)<br>- avg_sentiment (float): средняя тональность отзывов по результатам NLP-анализа текста <br>- AvgLikes (float): среднее число реакций на один отзыв за год<br>- VarRating (float): дисперсия рейтингов внутри года, отражает разброс оценок |
| **Поисковая активность**| Google Trends (через Pytrends)         | Выборка ежемесячных значений Interest for Topic/Brand, затем усреднение по 12 месячным показателям за год | search_index                                         | search_index (float, 0–100): годовой индекс интереса к бренду в Google Trends. Значение 100 соответствует пику за весь период, 0 — минимальный уровень. |
| **Макроэкономика**      | Росстат             | Годовые значения по РФ (фиксируются на уровне всей экономики, одинаковы для всех сетей) | cp_index<br>income_pop<br>FemaleShare            | - cp_index (float): индекс потребительских цен (CPI) на конец года <br>- income_pop (float): реальные располагаемые доходы населения, годовое изменение в процентах<br>- FemaleShare (float): доля женщин в общей численности населения РФ (%). |
| **Финансовые показатели** | Отчёты компаний, пресс-релизы, аналитические обзоры, базы данных (audit-it, РБК, публичные финансовые отчёты) | Ежегодная выручка по сети: сбор из различных источников, корректировка на инфляцию, конвертация в однородную единицу (млн или млрд руб.) | revenue<br>   | - revenue (float): годовая выручка сети в миллионах (или миллиардах) рублей <br>-  |
| **Дополнительные переменные** | Вычисляются на этапе эконометрического моделирования | создаются лог-преобразования | ln_revenue<br>ln_search_index<br>ln_review_vol | ln_revenue: натуральный логарифм годовой выручки (revenue > 0). Применён для стабилизации дисперсии и интерпретации коэффициентов как эластичностей.<br> ln_search_index: натуральный логарифм индекса поисковой активности. Обычно рассчитывают как ln(search_index + 1) (или +ε), чтобы корректно обработать нулевые значения и снизить скошенность распределения. <br> ln_review_vol: натуральный логарифм объёма отзывов за год. Вычисляется как ln(review_vol + 1) (или +ε) для учёта случаев, когда review_vol может быть 0, и для более нормального распределения в модели. |

> **Примечание** В репозитории хранится только итоговый агрегированный CSV. «Сырые» выгрузки отзывов имеют значительный объём (около 95 000 записей). При необходимости сбор этих данных можно воспроизвести с помощью примеров в scripts/ , но для воспроизведения эконометрического анализа достаточно агрегированного датасета.

 ## **scripts/**

Папка scripts/ содержит примеры «скелетного» кода для сбора отзывов:

- parse_yandex_maps.py — шаблон парсера отзывов с Яндекс.Карт.
- parse_otzovik.py — шаблон парсера отзывов с Otzovik.

**Особенности и дисклеймер:**

- Опубликованные скрипты демонстрируют лишь архитектуру парсера с Selenium: настройка браузера, навигация по страницам, поиск элементов, сбор данных (текст, рейтинг, год, реакции).  
- **Работоспособность селекторов** требует актуализации: HTML-структура сайтов меняется, поэтому перед запуском необходимо проверить и адаптировать CSS-селекторы.  
- **Captcha и ограничения**: возможны проверки со стороны площадок; парсер может требовать ручного решения CAPTCHA или пауз между запросами.  
- **Правила использования**: перед реальным сбором следует убедиться в соответствии с условиями использования платформ, чтобы не нарушать их политику.  
- **Сбор не обязателен для анализа**: агрегированный датасет хранится в data/df_aggregated.csv. Для воспроизведения эконометрического анализа достаточно готовых агрегатов. Парсеры предоставлены как отправная точка, а не «рабочий» код «из коробки».

**Запуск и адаптация:**

1. Установить зависимости ( selenium, pandas и т. д.) и ChromeDriver или иной WebDriver, совместимый с браузером.  
2. Проверить и при необходимости скорректировать:
   - Список начальных URL или логику поиска магазинов/товаров.  
   - CSS-селекторы для элементов страницы (отзыв, автор, дата, рейтинг, текст, реакции).  
3. При сборе соблюдать разумные интервалы между действиями (sleep, human-like scroll), чтобы снизить риск блокировки.  
4. Собранные «сырые» отзывы сохранять локально (например, в JSON/Excel), затем агрегировать в годовые метрики в Jupyter Notebook.  
  
 ## **notebooks/**

В папке notebooks/ находится ключевой файл panel_analysis.ipynb, который последовательно реализует полный цикл панельного эконометрического анализа:

**1. Предобработка и формирование панели**
   - Чтение сырых данных, агрегирование, предварительная инспекция 
   - Упорядочивание данных в формат панели: индексация по «сеть–год», проверка баланса панели.

**2. Диагностика и описательная статистика**  
   - Построение диаграмм рассеяния, распределений, корреляционных матриц для предварительного понимания взаимосвязей между переменными.  
   - Оценка первичных паттернов: направления корреляций, возможные нелинейности.

**3. Эконометрическое моделирование (Pooled OLS)**  
   - Оценка «сырой» Pooled OLS с полным набором регрессоров и последующий переход к лог-спецификации.  
   - Проверка стандартных предпосылок (линейность, мультиколлинеарность, нормальность остатков, гетероскедастичность, автокорреляция).  

**4. Переход к панельным моделям**
   - **Pooled OLS**: Просто OLS на всём датафрейме, без учёта того, к какой сети принадлежит наблюдение.
   - **LSDV (Least Squares Dummy Variables)**: Добавление фиктивных (dummy) переменных для каждой сети (кроме одной опорной).
   - **Fixed Effects (FE)**: оценка модели с фиксированными эффектами сети.  
   - **Random Effects (RE)**: оценка модели со случайными эффектами, проверка обоснованности через тест Хаусмана.  
   - Сравнение результатов FE vs RE: выбор оптимальной спецификации.

**5. Сравнение моделей и выбор лучшей спецификации**  
   - Сравнительные метрики (R-squared «within», тесты на корреляцию эффектов, информационные критерии, статистика F).  
   - Обоснование выбора финальной модели на основе статистики и экономической логики.


---
# Ключевые выводы по работе с данными


**1. Формируется «двухскоростной» рынок.**
Наиболее сильными игроками на рынке можно выделить три сети («Л’Этуаль», «Золотое яблоко», "Магнит косметик"), две из них («Золотое яблоко» и "Магнит косметик") за рассматриваемых период (2015-2024) продемострировали высокий  рост выручки c ≈ 30 млрд ₽ до > 150 млрд ₽, тогда как большая часть рассматриваемых сетей остались ≤ 50 млрд ₽. Высокая концентрация усиливает барьер входа и диктует разный потенциал роста для сетей-аутсайдеров и лидеров.

**2.Средний рейтинг сети дошёл до потолка в 4,3–4,4 звезды, но доля негатива остаётся дифференцированной.**
Даже при схожем среднеарифметическом значении у некоторых сетей каждое пятое-шестое сообщение негативно, тогда как у других негатив держится в пределах 3–5 %. Это указывает, что показатель звёзд часто сглаживает реальные проблемы клиентского опыта, и анализ отзывов по квантилям даёт более честную картину.

**3. Средняя тональность текстов росла заметно быстрее, чем рейтинг.**
С 2015 по 2024 г. она прибавила 25–40 % почти у всех сетей, что сигнализирует о смещении коммуникаций в сторону «дружелюбного тона». Разрыв между рейтинговыми «четвёрками» и «тройками» по эмоциональной окраске сузился, поэтому маркировка по sentiment-score помогает ловить ранние паттерны недовольства до того, как упадёт средняя оценка.

**4.Макроэкономика выступала фоном, но не главной движущей силой.**
Индекс потребительских цен колебался в узком коридоре — 101–113 % к базовому году, а реальные доходы падали до 2021 г., после чего отыграли 9,6 % за два года. Эти сдвиги отражаются в коэффициентах модели, однако объясняют лишь пятую часть межгодовой дисперсии выручки, тогда как digital-метрики задают основную динамику.

**5. Панельный анализ подтвердил преимущество модели случайных эффектов.**
Hausman-тест не выявил систематических расхождений FE и RE (p ≈ 1), а RE-оценки объясняют 73 % внутрисетевых колебаний выручки. Главный драйвер продаж — узнаваемость бренда в поиске. На втором месте — покупательская способность: рост реальных доходов населения на 1 п.п. даёт +3,2 % оборота. А вот сами оценки и «позитивность» текстов значения не имеют, а резонансные (много лайков) отзывы даже коррелируют с просадкой продаж — вероятно, потому что чаще обсуждают проблемы.

**6. Cамым сильным драйвером выручки выступает поисковый интерес к бренду**
По модели случайных эффектов 1-процентный рост относительного индекса Google Trends связан в среднем c увеличением выручки на ≈ 0,74 %. Эффект более чем в 20 раз превосходит влияние реальных доходов населения (β ≈ 0,03) и оставляет статистически незначимыми «классические» репутационные метрики — средний рейтинг, тональность и объём отзывов. Практически это означает, что любые активности, повышающие поисковый интерес (SEO, инфлюенс-кампании, контент-маркетинг), дают наибольшую отдачу: +10 % к поисковому интересу способно добавить ≈ 7–8 % оборота. Напротив, простое «накручивание» рейтингов без роста видимости почти не влияет на продажи. Поэтому бюджет продвижения целесообразно распределять в первую очередь на проекты, расширяющие цифровую узнаваемость бренда, а улучшение отзывов и сервисные инициативы использовать как поддерживающий, а не ключевой, рычаг роста.


---
# Бизнес-импликации


**1. Увеличивать органический поисковый трафик.**  
   Анализ показал: рост поискового интереса на 1% приводит примерно к 0,74% росту выручки в лог-формате. К примеру, кейс с золотым яблоком демонстрирует, что значительное повышение узнаваемости онлайн коррелирует с многократным ростом продаж.

**2. Поощрять содержательные отзывы и быстро реагировать на негатив.**  
   Модель показала, что среднее число реакций (лайков/дизлайков) на отзывы связано с динамикой выручки (отрицательный коэфф.). Это означает, что привлечение «лайков» само по себе не даёт роста, если отзывы поверхностные или слишком эмоционально окрашенные. Бизнесу стоит стимулировать клиентов оставлять подробный и конструктивный фидбэк, а также оперативно разбираться с негативными отзывами, чтобы минимизировать масштаб «скандалов» и укреплять доверие аудитории.

**3. Учитывать макроэкономический фон при планировании роста.**  
   Позитивная связь реальных доходов населения с выручкой подчёркивает, что сегмент косметики чувствителен к ценам. В периоды восстановления доходов (например, начиная с 2022 г.) стоит активнее запускать маркетинговые кампании и расширять ассортимент, тогда как в периоды спада рекомендуется оптимизировать ассортимент и фокусироваться на удержании текущих клиентов через программы лояльности и специальные предложения.
